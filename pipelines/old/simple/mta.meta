!config /home/unix/flannick/lap/projects/mta/config/mta.cfg

!title MTA paper

#Paths to output directories
#------
!key base_dir /humgen/diabetes/users/flannick/mta
!key unix_out_dir $base_dir/out
!key log_dir $base_dir/log
!key web_out_dir http://iwww.broadinstitute.org/~flannick/mta_out

#The project
#------------

v1 class project
v1 disp Version 1

v1 num_project_subsets 100

raw_dir prop scalar 
project raw_dir /humgen/diabetes/users/flannick/mta/raw

v1 project_variant_vcf_file /humgen/diabetes/t2d_exomes/pipeline/out/projects/v3/v3.clean.all.vcf.gz
v1 project_variant_vcf_index_file /humgen/diabetes/t2d_exomes/pipeline/out/projects/v3/v3.clean.all.vcf.gz.tbi
v1 project_extended_variant_exclude_file /humgen/diabetes/t2d_exomes/pipeline/out/projects/v3/v3.extended.variant.exclude

v1 project_maf_file @raw_dir/v3.maf.tsv

v1 project_gencode_gtf_gz_file @raw_dir/gencode.v19.annotation.gtf.gz
v1 project_gene_appris_file @raw_dir/appris_data.principal.txt

#The masks
#----------

lof_filter prop scalar
project lof_filter $m["Consequence"] ~ "(transcript_ablation|splice_donor_variant|splice_acceptor_variant|stop_gained|frameshift_variant|stop_lost|initiator_codon_variant)"

lof_mask class mask
lof_mask disp PTV
lof_mask mask_filter_condition @lof_filter
lof_mask sort 1
lof_mask color magenta

ns_strict_filter prop scalar
project ns_strict_filter ($m["PolyPhen"] ~ "probably_damaging" && $m["SIFT"] ~ "deleterious" && $m["MAF"] < 0.001)

ns_strict_mask class mask
ns_strict_mask disp PTV+NSstrict
ns_strict_mask r_disp PTV+NS[strict]
ns_strict_mask mask_filter_condition @lof_filter || @ns_strict_filter
ns_strict_mask sort 2
ns_strict_mask color orange

ns_strict_no_maf_filter prop scalar
project ns_strict_no_maf_filter ($m["PolyPhen"] ~ "probably_damaging" && $m["SIFT"] ~ "deleterious")

ns_strict_no_maf_mask class mask
ns_strict_no_maf_mask disp PTV+NSstrict All
ns_strict_no_maf_mask r_disp PTV+NS[strict]
ns_strict_no_maf_mask mask_filter_condition @lof_filter || @ns_strict_no_maf_filter
ns_strict_no_maf_mask sort 2
ns_strict_no_maf_mask color orange

ns_strict_13k_filter prop scalar
project ns_strict_13k_filter ($m["dbNSFP_LRT_pred"] == "D" && ($m["dbNSFP_MutationTaster_pred"] == "D" || ($m["dbNSFP_MutationTaster_pred"] == "A" && $m["dbNSFP_MutationTaster_pred"] != "NA")) && $m["dbNSFP_Polyphen2_HDIV_pred"] == "D" && $m["dbNSFP_Polyphen2_HVAR_pred"] == "D" && $m["SIFT"] ~ "deleterious")

ns_strict_13k_mask class mask
ns_strict_13k_mask disp PTV+NSstrict 13K
ns_strict_13k_mask r_disp PTV+NS[strict] 13K
ns_strict_13k_mask mask_filter_condition @lof_filter || @ns_strict_13k_filter
ns_strict_13k_mask sort 2
ns_strict_13k_mask color orange


ns_broad_filter prop scalar
project ns_broad_filter (($m["PolyPhen"] ~ "damaging" || $m["SIFT"] ~ "deleterious") && $m["MAF"] < 0.01)

ns_broad_mask class mask
ns_broad_mask disp PTV+NSbroad
ns_broad_mask r_disp PTV+NS[broad]
ns_broad_mask mask_filter_condition @lof_filter || @ns_strict_filter || @ns_broad_filter
ns_broad_mask sort 3
ns_broad_mask color yellow

ns_filter prop scalar
project ns_filter ($m["Consequence"] ~ "(inframe_insertion|inframe_deletion|missense_variant)" && $m["MAF"] < 0.01)

ns_mask class mask
ns_mask disp PTV+NS
ns_mask mask_filter_condition @lof_filter || @ns_strict_filter || @ns_broad_filter || @ns_filter
ns_mask sort 4
ns_mask color cyan

mask parent v1

#The genes
#----------

hnf4a class gene
hnf4a disp HNF4A
hnf4a ensembl_id ENSG00000101076

slc30a8 class gene
slc30a8 disp SLC30A8
slc30a8 ensembl_id ENSG00000164756

abcc8 class gene
abcc8 disp ABCC8
abcc8 ensembl_id	ENSG00000006071

pax4 class gene
pax4 disp PAX4
pax4 ensembl_id	ENSG00000106331

gck class gene
gck disp GCK
gck ensembl_id	ENSG00000106633

hnf1b class gene
hnf1b disp HNF1B
hnf1b ensembl_id	ENSG00000108753

hnf1a class gene
hnf1a disp HNF1A
hnf1a ensembl_id	ENSG00000135100

blk class gene
blk disp BLK
blk ensembl_id	ENSG00000136573

pdx1 class gene
pdx1 disp PDX1
pdx1 ensembl_id	ENSG00000139515

neurod1 class gene
neurod1 disp NEUROD1
neurod1 ensembl_id	ENSG00000162992

cel class gene
cel disp CEL
cel ensembl_id	ENSG00000170835

klf11 class gene
klf11 disp KLF11
klf11 ensembl_id	ENSG00000172059

kcnj11 class gene
kcnj11 disp KCNJ11
kcnj11 ensembl_id	ENSG00000187486

ins class gene
ins disp INS
ins ensembl_id	ENSG00000254647

pparg class gene
pparg disp PPARG
pparg ensembl_id ENSG00000132170

{ENSG00000072195,ENSG00000241635,ENSG00000102595,ENSG00000196531,ENSG00000140264,ENSG00000196531,ENSG00000197372,ENSG00000125952,ENSG00000140832,ENSG00000106852,ENSG00000152061,ENSG00000072195,ENSG00000198363,ENSG00000087460,ENSG00000116285,ENSG00000112335,ENSG00000109861,ENSG00000158874,ENSG00000186094,ENSG00000078403,ENSG00000120471,ENSG00000183317,ENSG00000141552,ENSG00000125952,ENSG00000147099} class gene
{ENSG00000072195,ENSG00000241635,ENSG00000102595,ENSG00000196531,ENSG00000140264,ENSG00000196531,ENSG00000197372,ENSG00000125952,ENSG00000140832,ENSG00000106852,ENSG00000152061,ENSG00000072195,ENSG00000198363,ENSG00000087460,ENSG00000116285,ENSG00000112335,ENSG00000109861,ENSG00000158874,ENSG00000186094,ENSG00000078403,ENSG00000120471,ENSG00000183317,ENSG00000141552,ENSG00000125952,ENSG00000147099} ensembl_id {ENSG00000072195,ENSG00000241635,ENSG00000102595,ENSG00000196531,ENSG00000140264,ENSG00000196531,ENSG00000197372,ENSG00000125952,ENSG00000140832,ENSG00000106852,ENSG00000152061,ENSG00000072195,ENSG00000198363,ENSG00000087460,ENSG00000116285,ENSG00000112335,ENSG00000109861,ENSG00000158874,ENSG00000186094,ENSG00000078403,ENSG00000120471,ENSG00000183317,ENSG00000141552,ENSG00000125952,ENSG00000147099}

angptl4 class gene
angptl4 disp ANGPTL4
angptl4 ensembl_id ENSG00000167772

angptl8 class gene
angptl8 disp ANGPTL8
angptl8 ensembl_id ENSG00000130173

apob class gene
apob disp APOB
apob ensembl_id ENSG00000084674

apoe class gene
apoe disp APOE
apoe ensembl_id ENSG00000130203

cblc class gene
cblc disp CBLC
cblc ensembl_id ENSG00000142273

cetp class gene
cetp disp CETP
cetp ensembl_id ENSG00000087237

col18a1 class gene
col18a1 disp COL18A1
col18a1 ensembl_id ENSG00000182871

lcat class gene
lcat disp LCAT
lcat ensembl_id ENSG00000213398

lipg class gene
lipg disp LIPG
lipg ensembl_id ENSG00000101670

lpl class gene
lpl disp LPL
lpl ensembl_id ENSG00000175445

map1a class gene
map1a disp MAP1A
map1a ensembl_id ENSG00000166963

pcsk7 class gene
pcsk7 disp PCSK7
pcsk7 ensembl_id ENSG00000160613

pcsk9 class gene
pcsk9 disp PCSK9
pcsk9 ensembl_id ENSG00000169174

znf259 class gene
znf259 disp ZNF259
znf259 ensembl_id ENSG00000109917

gene parent v1

#Special genes
#-------------

mody_pathogenic class special_gene_list
mody_pathogenic disp OMIM MODY Pathogenic Transcripts

mody_pathogenic gene_list {ENSG00000006071,ENSG00000136573,ENSG00000170835,ENSG00000106633,ENSG00000135100,ENSG00000108753,ENSG00000101076,ENSG00000254647,ENSG00000187486,ENSG00000172059,ENSG00000162992,ENSG00000106331,ENSG00000139515}
mody_pathogenic transcript_list {ENST00000302539,ENST00000259089,ENST00000372080,ENST00000403799,ENST00000541395,ENST00000225893,ENST00000316099,ENST00000250971,ENST00000339994,ENST00000305883,ENST00000295108,ENST00000341640,ENST00000381033}

mody_hgmd class special_gene_list
mody_hgmd disp OMIM MODY HGMD Transcripts

mody_hgmd gene_list {ENSG00000006071,ENSG00000136573,ENSG00000170835,ENSG00000106633,ENSG00000135100,ENSG00000101076,ENSG00000254647,ENSG00000187486,ENSG00000172059,ENSG00000162992,ENSG00000106331,ENSG00000139515}
mody_hgmd transcript_list {ENST00000389817,ENST00000259089,ENST00000372080,ENST00000403799,ENST00000257555,ENST00000316673,ENST00000250971,ENST00000339994,ENST00000305883,ENST00000295108,ENST00000341640,ENST00000381033}

hdl_hgmd class special_gene_list
hdl_hgmd disp HDL HGMD Transcripts
hdl_hgmd gene_list {ENSG00000160613,ENSG00000087237,ENSG00000213398,ENSG00000167772,ENSG00000101670,ENSG00000175445,ENSG00000130173}
hdl_hgmd transcript_list {ENST00000320934,ENST00000200676,ENST00000264005,ENST00000301455,ENST00000261292,ENST00000311322,ENST00000252453}

ldl_hgmd class special_gene_list
ldl_hgmd disp LDL HGMD Transcripts
ldl_hgmd gene_list {ENSG00000169174,ENSG00000084674,ENSG00000142273,ENSG00000130203}
ldl_hgmd transcript_list {ENST00000302118,ENST00000233242,ENST00000270279,ENST00000252486}

trig_hgmd class special_gene_list
trig_hgmd disp Triglycerides HGMD Transcripts
trig_hgmd gene_list {ENSG00000167772,ENSG00000175445,ENSG00000166963,ENSG00000130203,ENSG00000182871,ENSG00000109917}
trig_hgmd transcript_list {ENST00000301455,ENST00000311322,ENST00000300231,ENST00000252486,ENST00000400337,ENST00000227322}

special_gene_list parent project

#Simulations
#-----------

#n_samples,n_cases,pval
#one_sided
#effect_size_frac OR simulation_maf_effect_size_file
#variants_per_gene_dist_mask

10k_one_sided_norm class simulation
10k_one_sided_norm parent project
10k_one_sided_norm {n_samples,n_cases,one_sided} {50000,5000,1}
10k_one_sided_norm num_per_batch 5
10k_one_sided_norm sort 01
10k_one_sided_norm disp Dichotomous, Normal

10k_one_sided_norm_trans25 class simulation
10k_one_sided_norm_trans25 parent project
10k_one_sided_norm_trans25 {n_samples,n_cases,one_sided} {50000,5000,1}
10k_one_sided_norm_trans25 num_per_batch 5
10k_one_sided_norm_trans25 path_frac .25
10k_one_sided_norm_trans25 sort 012
10k_one_sided_norm_trans25 disp Dichotomous, Normal, 25% pathogenic

10k_one_sided_norm_trans50 class simulation
10k_one_sided_norm_trans50 parent project
10k_one_sided_norm_trans50 {n_samples,n_cases,one_sided} {50000,5000,1}
10k_one_sided_norm_trans50 num_per_batch 5
10k_one_sided_norm_trans50 path_frac .5
10k_one_sided_norm_trans50 sort 0125
10k_one_sided_norm_trans50 disp Dichotomous, Normal, 50% pathogenic

10k_two_sided_norm class simulation
10k_two_sided_norm parent project
10k_two_sided_norm {n_samples,n_cases,one_sided} {50000,5000,0}
10k_two_sided_norm num_per_batch 5
10k_two_sided_norm sort 015
10k_two_sided_norm disp Dichotomous, Normal Two-sided

10k_one_sided_lof class simulation
10k_one_sided_lof parent project
10k_one_sided_lof {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {50000,5000,1,1,lof_mask}
10k_one_sided_lof num_per_batch 5
10k_one_sided_lof sort 02
10k_one_sided_lof disp Dichotomous, Null only

10k_one_sided_strict_frac85 class simulation
10k_one_sided_strict_frac85 parent project
10k_one_sided_strict_frac85 {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {50000,5000,1,.85,ns_strict_mask}
10k_one_sided_strict_frac85 num_per_batch 5
10k_one_sided_strict_frac85 sort 03
10k_one_sided_strict_frac85 disp Dichotomous, PolyPhen

10k_one_sided_ns_frac50 class simulation
10k_one_sided_ns_frac50 parent project
10k_one_sided_ns_frac50 {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {50000,5000,1,.5,ns_mask}
10k_one_sided_ns_frac50 num_per_batch 5
10k_one_sided_ns_frac50 sort 035
10k_one_sided_ns_frac50 disp Dichotomous, Half

10k_one_sided_ns_frac15 class simulation
10k_one_sided_ns_frac15 parent project
10k_one_sided_ns_frac15 {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {50000,5000,1,.15,ns_mask}
10k_one_sided_ns_frac15 num_per_batch 5
10k_one_sided_ns_frac15 sort 04
10k_one_sided_ns_frac15 disp Dichotomous, Optimal freq

10k_one_sided_mod class simulation
10k_one_sided_mod parent project
10k_one_sided_mod {n_samples,n_cases,one_sided,simulation_maf_effect_size_file,variants_per_gene_dist_mask} {50000,5000,1,@raw_dir/moderate_coupling_tau_0.5.maf_effect.txt,ns_mask}
10k_one_sided_mod num_per_batch 5
10k_one_sided_mod sort 05
10k_one_sided_mod disp Dichotomous, Moderate coupling

10k_one_sided_weak class simulation
10k_one_sided_weak parent project
10k_one_sided_weak {n_samples,n_cases,one_sided,simulation_maf_effect_size_file,variants_per_gene_dist_mask} {50000,5000,1,@raw_dir/weak_coupling_tau_0.1.maf_effect.txt,ns_mask}
10k_one_sided_weak num_per_batch 5
10k_one_sided_weak sort 06
10k_one_sided_weak disp Dichotomous, Weak coupling

10k_one_sided_tight class simulation
10k_one_sided_tight parent project
10k_one_sided_tight {n_samples,n_cases,one_sided,simulation_maf_effect_size_file,variants_per_gene_dist_mask} {50000,5000,1,@raw_dir/tight_coupling_tau_1.maf_effect.txt,ns_mask}
10k_one_sided_tight num_per_batch 5
10k_one_sided_tight sort 07
10k_one_sided_tight disp Dichotomous, Tight coupling

10k_qt_one_sided_norm class simulation
10k_qt_one_sided_norm parent project
10k_qt_one_sided_norm {n_samples,n_cases,one_sided} {10000,0,1}
10k_qt_one_sided_norm num_per_batch 5
10k_qt_one_sided_norm sort 11
10k_qt_one_sided_norm disp Quantitative, Normal

10k_qt_one_sided_norm_trans25 class simulation
10k_qt_one_sided_norm_trans25 parent project
10k_qt_one_sided_norm_trans25 {n_samples,n_cases,one_sided} {10000,0,1}
10k_qt_one_sided_norm_trans25 num_per_batch 5
10k_qt_one_sided_norm_trans25 path_frac .25
10k_qt_one_sided_norm_trans25 sort 112
10k_qt_one_sided_norm_trans25 disp Quantitative, Normal, 25% pathogenic

10k_qt_one_sided_norm_trans50 class simulation
10k_qt_one_sided_norm_trans50 parent project
10k_qt_one_sided_norm_trans50 {n_samples,n_cases,one_sided} {10000,0,1}
10k_qt_one_sided_norm_trans50 num_per_batch 5
10k_qt_one_sided_norm_trans50 path_frac .5
10k_qt_one_sided_norm_trans50 sort 1125
10k_qt_one_sided_norm_trans50 disp Quantitative, Normal, 50% pathogenic

10k_qt_two_sided_norm class simulation
10k_qt_two_sided_norm parent project
10k_qt_two_sided_norm {n_samples,n_cases,one_sided} {10000,0,0}
10k_qt_two_sided_norm num_per_batch 5
10k_qt_two_sided_norm sort 115
10k_qt_two_sided_norm disp Quantitative, Normal Two-sided

10k_qt_one_sided_lof class simulation
10k_qt_one_sided_lof parent project
10k_qt_one_sided_lof {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {10000,0,1,1,lof_mask}
10k_qt_one_sided_lof num_per_batch 5
10k_qt_one_sided_lof sort 12
10k_qt_one_sided_lof disp Quantitative, Null only

10k_qt_one_sided_strict_frac85 class simulation
10k_qt_one_sided_strict_frac85 parent project
10k_qt_one_sided_strict_frac85 {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {10000,0,1,.85,ns_strict_mask}
10k_qt_one_sided_strict_frac85 num_per_batch 5
10k_qt_one_sided_strict_frac85 sort 13
10k_qt_one_sided_strict_frac85 disp Quantitative, PolyPhen

10k_qt_one_sided_ns_frac50 class simulation
10k_qt_one_sided_ns_frac50 parent project
10k_qt_one_sided_ns_frac50 {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {10000,0,1,.5,ns_mask}
10k_qt_one_sided_ns_frac50 num_per_batch 5
10k_qt_one_sided_ns_frac50 sort 135
10k_qt_one_sided_ns_frac50 disp Quantitative, Half

10k_qt_one_sided_ns_frac15 class simulation
10k_qt_one_sided_ns_frac15 parent project
10k_qt_one_sided_ns_frac15 {n_samples,n_cases,one_sided,effect_size_frac,variants_per_gene_dist_mask} {10000,0,1,.15,ns_mask}
10k_qt_one_sided_ns_frac15 num_per_batch 5
10k_qt_one_sided_ns_frac15 sort 14
10k_qt_one_sided_ns_frac15 disp Quantitative, Optimal freq

10k_qt_one_sided_mod class simulation
10k_qt_one_sided_mod parent project
10k_qt_one_sided_mod {n_samples,n_cases,one_sided,simulation_maf_effect_size_file,variants_per_gene_dist_mask} {10000,0,1,@raw_dir/moderate_coupling_tau_0.5.maf_effect.txt,ns_mask}
10k_qt_one_sided_mod num_per_batch 5
10k_qt_one_sided_mod sort 15
10k_qt_one_sided_mod disp Quantitative, Moderate Coupling

10k_qt_one_sided_weak class simulation
10k_qt_one_sided_weak parent project
10k_qt_one_sided_weak {n_samples,n_cases,one_sided,simulation_maf_effect_size_file,variants_per_gene_dist_mask} {10000,0,1,@raw_dir/weak_coupling_tau_0.1.maf_effect.txt,ns_mask}
10k_qt_one_sided_weak num_per_batch 5
10k_qt_one_sided_weak sort 16
10k_qt_one_sided_weak disp Quantitative, Weak Coupling

10k_qt_one_sided_tight class simulation
10k_qt_one_sided_tight parent project
10k_qt_one_sided_tight {n_samples,n_cases,one_sided,simulation_maf_effect_size_file,variants_per_gene_dist_mask} {10000,0,1,@raw_dir/tight_coupling_tau_1.maf_effect.txt,ns_mask}
10k_qt_one_sided_tight num_per_batch 5
10k_qt_one_sided_tight sort 17
10k_qt_one_sided_tight disp Quantitative, Tight Coupling

simulation num_fold_breaks 150

#Burden tests
#------------

mono_all_{hgmd,path} class burden_test
mono_all_{hgmd,path} parent mask
mono_all_{hgmd,path} sort 0{1,2}
mono_all_{hgmd,path} burden_test_gene_path_trans_list_file @raw_dir/mono.all.{hgmd,path}

mono_strict_{hgmd,path} class burden_test
mono_strict_{hgmd,path} parent mask
mono_strict_{hgmd,path} sort 0{3,4}
mono_strict_{hgmd,path} burden_test_gene_path_trans_list_file @raw_dir/mono.strict.{hgmd,path}

mono_mody_{hgmd,path} class burden_test
mono_mody_{hgmd,path} parent mask
mono_mody_{hgmd,path} sort 0{5,6}
mono_mody_{hgmd,path} burden_test_gene_path_trans_list_file @raw_dir/mono.mody.{hgmd,path}

mono_{all_hgmd,all_path,strict_hgmd,strict_path,mody_hgmd,mody_path} burden_test_ped_file /humgen/diabetes/t2d_exomes/pipeline/out/projects/v3/phenos/t2d/t2d.epacts.covar.unrelated.ped
mono_{all_hgmd,all_path,strict_hgmd,strict_path,mody_hgmd,mody_path} dichotomous 1

#hdl_hgmd_{all,medex} class burden_test
#hdl_hgmd_{all,medex} parent mask
#hdl_hgmd_{all,medex} sort 0{7,8}
#hdl_hgmd_{all,medex} burden_test_gene_path_trans_list_file @raw_dir/hdl.hgmd
#hdl_hgmd_all burden_test_ped_file @raw_dir/HDL_ALL_RAW_INV.epacts.covar.unrelated.ped
#hdl_hgmd_medex burden_test_ped_file @raw_dir/HDLexcmed_ALL_RAW_INV.epacts.covar.unrelated.ped

#ldl_hgmd_{all,medex} class burden_test
#ldl_hgmd_{all,medex} parent mask
#ldl_hgmd_{all,medex} sort 0{8,9}
#ldl_hgmd_{all,medex} burden_test_gene_path_trans_list_file @raw_dir/ldl.hgmd
#ldl_hgmd_all burden_test_ped_file @raw_dir/LDLcaladj_ALL_RAW_INV.epacts.covar.unrelated.ped
#ldl_hgmd_medex burden_test_ped_file @raw_dir/LDLcalexcmed_ALL_RAW_INV.epacts.covar.unrelated.ped

#trig_hgmd_{all,medex} class burden_test
#trig_hgmd_{all,medex} parent mask
#trig_hgmd_{all,medex} sort {10,11}
#trig_hgmd_{all,medex} burden_test_gene_path_trans_list_file @raw_dir/trig.hgmd
#trig_hgmd_all burden_test_ped_file @raw_dir/TG_ALL_LOG_INV.epacts.covar.unrelated.ped
#trig_hgmd_medex burden_test_ped_file @raw_dir/TGexcmed_ALL_LOG_INV.epacts.covar.unrelated.ped

